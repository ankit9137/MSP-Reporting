<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MSP Leadership Dashboard</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
  <style>
    :root {
      --sidebar-bg: #0f172a;
      --main-bg: #f8fafc;
      --sidebar-text: #94a3b8;
      --sidebar-active: #ffffff;
      --card-bg: #ffffff;
      --accent: #3b82f6;
      --border: #e2e8f0;
      --text: #1e293b;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: system-ui, sans-serif; background: var(--main-bg); color: var(--text); display: flex; min-height: 100vh; }
    
    /* Sidebar */
    aside { width: 240px; background: var(--sidebar-bg); color: var(--sidebar-text); padding: 24px 0; flex-shrink: 0; }
    .brand { padding: 0 24px 32px; color: #fff; font-weight: 700; font-size: 18px; }
    nav ul { list-style: none; }
    nav li { padding: 12px 24px; cursor: pointer; transition: all 0.2s; }
    nav li:hover { background: #1e293b; color: #fff; }
    nav li.active { background: var(--accent); color: #fff; border-right: 4px solid #fff; }
    
    /* Main Content */
    main { flex-grow: 1; padding: 32px; overflow-y: auto; }
    header { margin-bottom: 32px; }
    .page-title { font-size: 24px; font-weight: 700; margin-bottom: 4px; }
    .last-updated { font-size: 12px; color: #64748b; }

    .tab-content { display: none; }
    .tab-content.active { display: block; }

    /* Cards */
    .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 32px; }
    .stat-card { background: var(--card-bg); padding: 24px; border-radius: 12px; border: 1px solid var(--border); box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
    .stat-label { font-size: 12px; color: #64748b; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 8px; }
    .stat-value { font-size: 32px; font-weight: 800; color: var(--text); }

    /* Charts */
    .charts-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 24px; margin-bottom: 32px; }
    .chart-container { background: #fff; padding: 24px; border-radius: 12px; border: 1px solid var(--border); }

    /* Table */
    .table-container { background: #fff; border-radius: 12px; border: 1px solid var(--border); overflow: hidden; }
    .table-controls { padding: 16px 24px; border-bottom: 1px solid var(--border); display: flex; gap: 16px; align-items: center; background: #fff; }
    .search-input { padding: 8px 12px; border-radius: 6px; border: 1px solid var(--border); font-size: 14px; width: 300px; outline: none; }
    .search-input:focus { border-color: var(--accent); box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.1); }
    .filter-select { padding: 8px 12px; border-radius: 6px; border: 1px solid var(--border); font-size: 14px; outline: none; cursor: pointer; }
    
    table { width: 100%; border-collapse: collapse; font-size: 14px; table-layout: auto; }
    th { background: #f1f5f9; text-align: left; padding: 12px 16px; font-weight: 600; color: #475569; cursor: pointer; user-select: none; position: relative; }
    th:hover { background: #e2e8f0; }
    th::after { content: 'â†•'; position: absolute; right: 8px; opacity: 0.3; }
    td { padding: 12px 16px; border-bottom: 1px solid var(--border); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    tr:last-child td { border-bottom: none; }
    tr.clickable { cursor: pointer; transition: background 0.2s; }
    tr.clickable:hover { background: #f8fafc; }

    /* Detail Modal/Panel Overlay */
    .modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.5); display: none; align-items: center; justify-content: center; z-index: 1000; }
    .modal { background: #fff; width: 90%; max-width: 900px; height: 80vh; border-radius: 16px; display: flex; flex-direction: column; overflow: hidden; }
    .modal-header { padding: 20px 24px; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; }
    .modal-title { font-size: 18px; font-weight: 700; }
    .modal-close { cursor: pointer; font-size: 24px; color: #64748b; }
    .modal-body { flex-grow: 1; padding: 24px; overflow-y: auto; display: grid; grid-template-columns: 1fr 1fr; gap: 24px; }
    .detail-section h3 { font-size: 14px; margin-bottom: 12px; color: #64748b; text-transform: uppercase; }
    .detail-list { list-style: none; font-size: 13px; }
    .detail-list li { padding: 8px 12px; border-bottom: 1px solid #f1f5f9; }
  </style>
</head>
<body>
  <aside>
    <div class="brand">MSP LEADERSHIP</div>
    <nav>
      <ul>
        <li data-tab="overview" class="active">Overview</li>
        <li data-tab="users">Users</li>
        <li data-tab="devices">Devices</li>
        <li data-tab="clients">Clients</li>
      </ul>
    </nav>
  </aside>

  <main>
    <header>
      <div class="page-title" id="activeTabTitle">Dashboard Overview</div>
      <div class="last-updated" id="lastUpdated">...</div>
    </header>

    <!-- OVERVIEW TAB -->
    <div id="overview" class="tab-content active">
      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-label">Total Clients</div>
          <div class="stat-value" id="totalClients">-</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Licensed Users</div>
          <div class="stat-value" id="totalUsers">-</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Total Devices</div>
          <div class="stat-value" id="totalDevices">-</div>
        </div>
      </div>

      <div class="charts-grid">
        <div class="chart-container">
          <canvas id="usersChart"></canvas>
        </div>
        <div class="chart-container">
          <canvas id="devicesChart"></canvas>
        </div>
      </div>

      <h3>Client Summary</h3>
      <div class="table-container" style="margin-top:16px;">
        <table>
          <thead>
            <tr>
              <th>Client Name</th>
              <th>Licensed Users</th>
              <th>Devices</th>
            </tr>
          </thead>
          <tbody id="overviewTableBody"></tbody>
        </table>
      </div>
    </div>

    <!-- USERS TAB -->
    <div id="users" class="tab-content">
      <div class="table-container">
        <div class="table-controls">
          <input type="text" class="search-input" id="usersSearch" placeholder="Search users, clients, or licenses...">
          <select class="filter-select" id="usersClientFilter">
            <option value="">All Clients</option>
          </select>
          <div class="last-updated" id="usersCountLabel" style="margin-left:auto; font-weight:600;">Showing: 0 users</div>
        </div>
        <table id="usersTable">
          <thead>
            <tr>
              <th onclick="sortTable('usersTable', 0)">Client</th>
              <th onclick="sortTable('usersTable', 1)">Display Name</th>
              <th onclick="sortTable('usersTable', 2)">UPN</th>
              <th onclick="sortTable('usersTable', 3)">License</th>
            </tr>
          </thead>
          <tbody id="usersTableBody"></tbody>
        </table>
      </div>
    </div>

    <!-- DEVICES TAB -->
    <div id="devices" class="tab-content">
      <div class="table-container">
        <div class="table-controls">
          <input type="text" class="search-input" id="devicesSearch" placeholder="Search devices, clients, or OS...">
          <div class="last-updated" id="devicesCountLabel" style="margin-left:auto; font-weight:600;">Showing: 0 devices</div>
        </div>
        <table id="devicesTable">
          <thead>
            <tr>
              <th onclick="sortTable('devicesTable', 0)">Client</th>
              <th onclick="sortTable('devicesTable', 1)">Device Name</th>
              <th onclick="sortTable('devicesTable', 2)">Operating System</th>
            </tr>
          </thead>
          <tbody id="devicesTableBody"></tbody>
        </table>
      </div>
    </div>

    <!-- CLIENTS TAB -->
    <div id="clients" class="tab-content">
      <div class="table-container">
        <table>
          <thead>
            <tr>
              <th>Client Name</th>
              <th>Users</th>
              <th>Devices</th>
            </tr>
          </thead>
          <tbody id="clientsTableBody"></tbody>
        </table>
      </div>
    </div>
  </main>

  <!-- Drill-down Modal -->
  <div class="modal-overlay" id="modalOverlay">
    <div class="modal">
      <div class="modal-header">
        <div class="modal-title" id="modalTitle">Client Details</div>
        <div class="modal-close" id="modalClose">&times;</div>
      </div>
      <div class="modal-body">
        <div class="detail-section">
          <h3>Licensed Users</h3>
          <ul class="detail-list" id="modalUserList"></ul>
        </div>
        <div class="detail-section">
          <h3>Devices</h3>
          <ul class="detail-list" id="modalDeviceList"></ul>
        </div>
      </div>
    </div>
  </div>

  <script src="./dashboard-data.js"></script>
  <script src="./app.js"></script>
</body>
</html>
